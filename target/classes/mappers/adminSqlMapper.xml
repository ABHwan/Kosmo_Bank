<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
        
<mapper namespace="com.spring.bank.admin.dao.AdminDAO">

	<!-- 관리자 로그인 -->
	<select id="SelectUser" parameterType="String" resultType="com.spring.bank.user.vo.UserVO">
    	SELECT * FROM admin WHERE member_id = #{member_id}
    </select>
	
	<!-- 관리자페이지 회원수(전체) -->
	<select id="getCustomerCnt" resultType="int">
		SELECT COUNT(*) as cnt FROM members
	</select>
	
	<!-- 관리자페이지(회원목록) -->
	<select id="getCustomerList" parameterType="java.util.Map" resultType="com.spring.bank.user.vo.UserVO">
		<![CDATA[
		SELECT * FROM
			(SELECT member_id, member_name, member_birth, member_hp, member_email, member_indate, member_addr1, member_addr2, member_addr3, member_zipcode, rowNum rNum 
				FROM (SELECT * FROM members ORDER BY member_indate DESC)
			) WHERE rNum >= #{start} and rNum <= #{end}
		]]>	
	</select>
	
	<!-- 관리자페이지 회원수(검색어별) -->
	<select id="getCustomerSearchCnt" parameterType="String" resultType="int">
		<![CDATA[ 
		SELECT COUNT(*) as cnt FROM members WHERE member_name LIKE '%'||#{search}||'%'
		]]>
	</select>
	
	<!-- 관리자페이지(회원검색) -->
	<select id="getCustomerSearchList" parameterType="java.util.Map" resultType="com.spring.bank.user.vo.UserVO">
		<![CDATA[
		SELECT * FROM
			(SELECT member_id, member_name, member_birth, member_hp, member_email, member_indate, member_addr1, member_addr2, member_addr3, member_zipcode, rowNum rNum 
				FROM (SELECT * FROM members WHERE member_name LIKE '%'||#{search}||'%' ORDER BY member_indate DESC)
			) WHERE rNum >= #{start} and rNum <= #{end}
		]]>	
	</select>
	
	<!-- 관리자 회원삭제 -->
	<delete id="deleteCustomer" parameterType="String">
		DELETE FROM members WHERE member_id IN ( #{member_id} )
	</delete>
	
	<!-- 관리자 페이지 예금 상품 등록 -->
	<insert id="insertDepositProduct" parameterType="com.spring.bank.product.vo.DepositProductVO">
		INSERT INTO deposit_product(deposit_product_name, deposit_product_summary, deposit_product_date, deposit_product_interRate, deposit_product_type, deposit_product_maxDate, deposit_product_minDate, deposit_product_minPrice, deposit_product_explanation, deposit_product_notice, deposit_product_bankCode)
		VALUES(#{deposit_product_name}, #{deposit_product_summary}, sysdate, #{deposit_product_interRate}, #{deposit_product_type}, #{deposit_product_maxDate}, #{deposit_product_minDate}, #{deposit_product_minPrice}, #{deposit_product_explanation}, #{deposit_product_notice}, #{deposit_product_bankCode})
	</insert>
	
	<!-- 관리자 페이지 예금 상품 수 -->
	<select id="getDepositProductCnt" resultType="int">
		SELECT COUNT(*) as cnt FROM deposit_product
	</select>
	
	<!-- 관리자 페이지 예금 상품 조회 -->
	<select id="selectDepositProduct" parameterType="java.util.Map" resultType="com.spring.bank.product.vo.DepositProductVO">
		<![CDATA[
		SELECT * FROM
			(SELECT deposit_product_name, deposit_product_summary, deposit_product_date, deposit_product_interrate, deposit_product_type, deposit_product_maxdate, deposit_product_mindate, deposit_product_minprice, deposit_product_bankcode, rowNum rNum 
				FROM (SELECT * FROM deposit_product ORDER BY deposit_product_date DESC)
			) WHERE rNum >= #{start} and rNum <= #{end}
		]]>	
	</select>
	
	<!-- 관리자 페이지 예금 상품 수(검색결과수)  -->
	<select id="getDepositProductSearchCnt" parameterType="String" resultType="int">
		<![CDATA[ 
		SELECT COUNT(*) as cnt FROM deposit_product WHERE deposit_product_name LIKE '%'||#{search}||'%'
		]]>
	</select>
	
	<!-- 관리자 페이지 예금 상품 검색(입력받아서 검색) -->
	<select id="searchDepositProduct" parameterType="java.util.Map" resultType="com.spring.bank.product.vo.DepositProductVO">
		<![CDATA[
		SELECT * FROM
			(SELECT deposit_product_name, deposit_product_summary, deposit_product_date, deposit_product_interrate, deposit_product_type, deposit_product_maxdate, deposit_product_mindate, deposit_product_minprice, deposit_product_bankcode, rowNum rNum 
				FROM (SELECT * FROM deposit_product WHERE deposit_product_name LIKE '%'||#{search}||'%' ORDER BY deposit_product_date DESC)
			) WHERE rNum >= #{start} and rNum <= #{end}
		]]>	
	</select>
	
	<!-- 관리자 페이지 예금 상품 수정 -->
	<update id="updateDepositProduct" parameterType="com.spring.bank.product.vo.DepositProductVO">
	
	</update>
	
	<!-- 관리자 페이지 예금 상품 삭제 -->
	<delete id="deleteDepositProduct" parameterType="String">
		DELETE FROM deposit_product WHERE deposit_product_name IN ( #{deposit_product_name} )
	</delete>
	
</mapper>